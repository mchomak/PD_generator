ИНСТРУКЦИЯ ПО ЗАПУСКУ ГЕНЕРАТОРА ПЛАКАТОВ (postergen.exe)

1) Что делает программа
postergen.exe автоматически создаёт PDF-плакаты формата A1 по единому шаблону:
- берёт данные проектов из Excel (.xlsx)
- берёт изображения проектов и логотипы из папки images
- сохраняет готовые плакаты в папку output

Программа не требует ввода аргументов — просто запускается из папки с файлами.


2) Какие файлы нужны (минимум)

Положите всё в одну папку, например PosterGen/:

PosterGen/
  postergen.exe
  projects.xlsx
  images/
    101.jpg
    102.png
    ...
    logo1.png        (нижний логотип)
    logo2.png        (логотип выше)
  config.yaml        (необязательно)
  fonts/             (необязательно, но рекомендуется)
    DejaVuSans.ttf
    DejaVuSans-Bold.ttf

Обязательные:
1) postergen.exe — исполняемый файл программы
2) *.xlsx — один Excel-файл с проектами (если их несколько, берётся самый новый)
3) images/ — папка с картинками проектов

Картинки проектов:
- Рекомендуемый формат имён: project_id.jpg или project_id.png
  Пример: 101.png, 102.jpg
- project_id берётся из столбца Excel.

Логотипы университета:
В папке images/:
- logo1.* — логотип внизу слева
- logo2.* — логотип над logo1
- Поддерживаются расширения: .png, .jpg, .jpeg, .webp

Если logo2 отсутствует — будет нарисован только logo1.
Название вуза находится внутри картинки — отдельно текстом не печатается.


3) Как запустить

Вариант 1 (самый простой):
1) Проверьте, что рядом с postergen.exe лежит Excel и папка images/
2) Дважды кликните по postergen.exe
3) Дождитесь сообщения об итогах

Вариант 2 (через командную строку — удобнее смотреть ошибки):
1) Откройте папку
2) В адресной строке проводника напишите cmd → Enter
3) Выполните:
   postergen.exe


4) Где результат
После запуска появится папка:

output/
  101_Название_проекта.pdf
  102_Умный_мониторинг_энергии.pdf
  ...


5) Формат Excel (какие столбцы нужны)
По умолчанию ожидаются колонки:
- project_id — ID проекта (используется для связи с картинкой)
- project_name — название проекта (печатается слева под картинкой)
- problem
- solution
- product
- team

Если ваши названия колонок отличаются — это настраивается в config.yaml (см. ниже).


6) Конфиг config.yaml — что он делает
config.yaml не обязателен.
Если он есть рядом с exe — программа применит настройки из него.
Если нет — используются настройки по умолчанию.

Основные блоки конфига и смысл:

6.1 columns
Настройка соответствия колонок Excel внутренним полям.
Если у вас в Excel “Название проекта” вместо project_name, вы прописываете это тут.

Пример:
columns:
  project_id: "ID"
  project_name: "Название проекта"
  problem: "Проблема"
  solution: "Решение"
  product: "Продукт"
  team: "Команда"

6.2 page
Размер страницы и шаблонные размеры.
height_mm: 841 или 840 (если ваш исходный шаблон рассчитан на 840)

Пример:
page:
  width_mm: 594
  height_mm: 841

6.3 fonts
Шрифты и размеры текста.
Важно для русского текста: лучше использовать fonts/DejaVuSans*.ttf
min_font_size — минимальный размер, ниже которого текст не уменьшается
Если текст не помещается — уменьшается, затем обрезается с “...”.

Пример:
fonts:
  title_font: "DejaVuSans-Bold"
  heading_font: "DejaVuSans-Bold"
  body_font: "DejaVuSans"
  title_size: 26
  heading_size: 12
  body_size: 10
  min_font_size: 7
  line_spacing: 1.2

6.4 images
Режим размещения верхней картинки проекта:
- contain — вписать целиком без обрезки
- cover — заполнить всю область, возможна обрезка

6.5 logos
Размер и отступы области логотипов.
- height_mm — высота зоны логотипов снизу слева
- spacing_mm — расстояние между logo1 и logo2
- margin_left_mm, margin_bottom_mm — отступы от края

Пример:
logos:
  height_mm: 60
  spacing_mm: 6
  margin_left_mm: 40
  margin_bottom_mm: 20


7) Рекомендации (чтобы не было квадратов вместо русского текста)
Добавьте рядом папку fonts/ и положите туда:
- DejaVuSans.ttf
- DejaVuSans-Bold.ttf

И укажите эти шрифты в config.yaml (см. пример выше).


8) Типовые ошибки и что делать
- “No .xlsx file found” — положите один Excel рядом с exe
- “Images folder not found” — создайте папку images/ рядом с exe
- Плакат без картинки — проверьте, что файл называется как project_id (например 102.png)
- Текст не влез — уменьшите текст в Excel или настройте fonts (например min_font_size)
